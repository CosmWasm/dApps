{"ast":null,"code":"var _jsxFileName = \"/home/abefernan/cosmwasm/dApps/packages/name-service/src/service/wallet.tsx\";\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport { createClient, loadOrCreateWallet } from \"./sdk\";\nconst defaultContext = {\n  initialized: false,\n  address: \"\",\n  init: () => {\n    return;\n  },\n  getClient: () => {\n    throw new Error(\"not yet initialized\");\n  }\n};\nconst CosmWasmContext = React.createContext(defaultContext);\nexport const useSdk = () => React.useContext(CosmWasmContext);\nexport function BurnerWalletProvider({\n  config,\n  children\n}) {\n  return /*#__PURE__*/React.createElement(SdkProvider, {\n    config: config,\n    loadWallet: loadOrCreateWallet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 5\n    }\n  }, children);\n}\nexport function SdkProvider({\n  config,\n  loadWallet,\n  children\n}) {\n  const contextWithInit = { ...defaultContext,\n    init: init\n  };\n  const [value, setValue] = useState(contextWithInit);\n\n  function init() {\n    loadWallet(config.addressPrefix).then(signer => createClient(config.httpUrl, signer)).then(async client => {\n      const address = client.senderAddress; // load from faucet if needed\n\n      if (config.faucetUrl) {\n        var _acct$balance;\n\n        const acct = await client.getAccount();\n\n        if (!(acct === null || acct === void 0 ? void 0 : (_acct$balance = acct.balance) === null || _acct$balance === void 0 ? void 0 : _acct$balance.length)) {\n          await fetch(config.faucetUrl, {\n            method: \"POST\",\n            body: JSON.stringify({\n              ticker: config.ticker,\n              address\n            })\n          });\n        }\n      }\n\n      setValue({\n        initialized: true,\n        address: address,\n        init: () => {\n          return;\n        },\n        getClient: () => client\n      });\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(CosmWasmContext.Provider, {\n    value: value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 10\n    }\n  }, children);\n}","map":{"version":3,"sources":["/home/abefernan/cosmwasm/dApps/packages/name-service/src/service/wallet.tsx"],"names":["React","useState","createClient","loadOrCreateWallet","defaultContext","initialized","address","init","getClient","Error","CosmWasmContext","createContext","useSdk","useContext","BurnerWalletProvider","config","children","SdkProvider","loadWallet","contextWithInit","value","setValue","addressPrefix","then","signer","httpUrl","client","senderAddress","faucetUrl","acct","getAccount","balance","length","fetch","method","body","JSON","stringify","ticker"],"mappings":";AAGA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,QAAyB,OAAzB;AAEA,SAASC,YAAT,EAAuBC,kBAAvB,QAAiD,OAAjD;AASA,MAAMC,cAAmC,GAAG;AAC1CC,EAAAA,WAAW,EAAE,KAD6B;AAE1CC,EAAAA,OAAO,EAAE,EAFiC;AAG1CC,EAAAA,IAAI,EAAE,MAAM;AACV;AACD,GALyC;AAM1CC,EAAAA,SAAS,EAAE,MAA6B;AACtC,UAAM,IAAIC,KAAJ,CAAU,qBAAV,CAAN;AACD;AARyC,CAA5C;AAWA,MAAMC,eAAe,GAAGV,KAAK,CAACW,aAAN,CAAyCP,cAAzC,CAAxB;AAEA,OAAO,MAAMQ,MAAM,GAAG,MAA2BZ,KAAK,CAACa,UAAN,CAAiBH,eAAjB,CAA1C;AAQP,OAAO,SAASI,oBAAT,CAA8B;AAAEC,EAAAA,MAAF;AAAUC,EAAAA;AAAV,CAA9B,EAA4F;AACjG,sBACE,oBAAC,WAAD;AAAa,IAAA,MAAM,EAAED,MAArB;AAA6B,IAAA,UAAU,EAAEZ,kBAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGa,QADH,CADF;AAKD;AAQD,OAAO,SAASC,WAAT,CAAqB;AAAEF,EAAAA,MAAF;AAAUG,EAAAA,UAAV;AAAsBF,EAAAA;AAAtB,CAArB,EAAsF;AAC3F,QAAMG,eAAe,GAAG,EAAE,GAAGf,cAAL;AAAqBG,IAAAA,IAAI,EAAEA;AAA3B,GAAxB;AACA,QAAM,CAACa,KAAD,EAAQC,QAAR,IAAoBpB,QAAQ,CAACkB,eAAD,CAAlC;;AAEA,WAASZ,IAAT,GAAgB;AACdW,IAAAA,UAAU,CAACH,MAAM,CAACO,aAAR,CAAV,CACGC,IADH,CACSC,MAAD,IAAYtB,YAAY,CAACa,MAAM,CAACU,OAAR,EAAiBD,MAAjB,CADhC,EAEGD,IAFH,CAEQ,MAAOG,MAAP,IAAkB;AACtB,YAAMpB,OAAO,GAAGoB,MAAM,CAACC,aAAvB,CADsB,CAEtB;;AACA,UAAIZ,MAAM,CAACa,SAAX,EAAsB;AAAA;;AACpB,cAAMC,IAAI,GAAG,MAAMH,MAAM,CAACI,UAAP,EAAnB;;AACA,YAAI,EAACD,IAAD,aAACA,IAAD,wCAACA,IAAI,CAAEE,OAAP,kDAAC,cAAeC,MAAhB,CAAJ,EAA4B;AAC1B,gBAAMC,KAAK,CAAClB,MAAM,CAACa,SAAR,EAAmB;AAC5BM,YAAAA,MAAM,EAAE,MADoB;AAE5BC,YAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEC,cAAAA,MAAM,EAAEvB,MAAM,CAACuB,MAAjB;AAAyBhC,cAAAA;AAAzB,aAAf;AAFsB,WAAnB,CAAX;AAID;AACF;;AAEDe,MAAAA,QAAQ,CAAC;AACPhB,QAAAA,WAAW,EAAE,IADN;AAEPC,QAAAA,OAAO,EAAEA,OAFF;AAGPC,QAAAA,IAAI,EAAE,MAAM;AACV;AACD,SALM;AAMPC,QAAAA,SAAS,EAAE,MAAMkB;AANV,OAAD,CAAR;AAQD,KAvBH;AAwBD;;AAED,sBAAO,oBAAC,eAAD,CAAiB,QAAjB;AAA0B,IAAA,KAAK,EAAEN,KAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyCJ,QAAzC,CAAP;AACD","sourcesContent":["import { SigningCosmWasmClient } from \"@cosmjs/cosmwasm\";\nimport { OfflineSigner } from \"@cosmjs/launchpad\";\nimport ky from \"ky\";\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport { AppConfig } from \"../config\";\nimport { createClient, loadOrCreateWallet } from \"./sdk\";\n\ninterface CosmWasmContextType {\n  readonly initialized: boolean;\n  readonly address: string;\n  readonly init: () => void;\n  readonly getClient: () => SigningCosmWasmClient;\n}\n\nconst defaultContext: CosmWasmContextType = {\n  initialized: false,\n  address: \"\",\n  init: () => {\n    return;\n  },\n  getClient: (): SigningCosmWasmClient => {\n    throw new Error(\"not yet initialized\");\n  },\n};\n\nconst CosmWasmContext = React.createContext<CosmWasmContextType>(defaultContext);\n\nexport const useSdk = (): CosmWasmContextType => React.useContext(CosmWasmContext);\n\ninterface ConfigProp {\n  readonly config: AppConfig;\n}\n\ntype BurnerWalletProviderProps = ConfigProp & React.HTMLAttributes<HTMLOrSVGElement>;\n\nexport function BurnerWalletProvider({ config, children }: BurnerWalletProviderProps): JSX.Element {\n  return (\n    <SdkProvider config={config} loadWallet={loadOrCreateWallet}>\n      {children}\n    </SdkProvider>\n  );\n}\n\ninterface ConfigWalletProps extends ConfigProp {\n  readonly loadWallet: (addressPrefix: string) => Promise<OfflineSigner>;\n}\n\ntype SdkProviderProps = ConfigWalletProps & React.HTMLAttributes<HTMLOrSVGElement>;\n\nexport function SdkProvider({ config, loadWallet, children }: SdkProviderProps): JSX.Element {\n  const contextWithInit = { ...defaultContext, init: init };\n  const [value, setValue] = useState(contextWithInit);\n\n  function init() {\n    loadWallet(config.addressPrefix)\n      .then((signer) => createClient(config.httpUrl, signer))\n      .then(async (client) => {\n        const address = client.senderAddress;\n        // load from faucet if needed\n        if (config.faucetUrl) {\n          const acct = await client.getAccount();\n          if (!acct?.balance?.length) {\n            await fetch(config.faucetUrl, {\n              method: \"POST\",\n              body: JSON.stringify({ ticker: config.ticker, address }),\n            });\n          }\n        }\n\n        setValue({\n          initialized: true,\n          address: address,\n          init: () => {\n            return;\n          },\n          getClient: () => client,\n        });\n      });\n  }\n\n  return <CosmWasmContext.Provider value={value}>{children}</CosmWasmContext.Provider>;\n}\n"]},"metadata":{},"sourceType":"module"}