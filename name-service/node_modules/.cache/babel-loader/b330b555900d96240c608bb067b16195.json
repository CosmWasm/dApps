{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport { SynchronousPromise } from 'synchronous-promise';\nimport ValidationError from '../ValidationError';\n\nvar promise = function promise(sync) {\n  return sync ? SynchronousPromise : Promise;\n};\n\nvar unwrapError = function unwrapError(errors) {\n  if (errors === void 0) {\n    errors = [];\n  }\n\n  return errors.inner && errors.inner.length ? errors.inner : [].concat(errors);\n};\n\nfunction scopeToValue(promises, value, sync) {\n  //console.log('scopeToValue', promises, value)\n  var p = promise(sync).all(promises); //console.log('scopeToValue B', p)\n\n  var b = p.catch(function (err) {\n    if (err.name === 'ValidationError') err.value = value;\n    throw err;\n  }); //console.log('scopeToValue c', b)\n\n  var c = b.then(function () {\n    return value;\n  }); //console.log('scopeToValue d', c)\n\n  return c;\n}\n/**\n * If not failing on the first error, catch the errors\n * and collect them in an array\n */\n\n\nexport function propagateErrors(endEarly, errors) {\n  return endEarly ? null : function (err) {\n    errors.push(err);\n    return err.value;\n  };\n}\nexport function settled(promises, sync) {\n  var Promise = promise(sync);\n  return Promise.all(promises.map(function (p) {\n    return Promise.resolve(p).then(function (value) {\n      return {\n        fulfilled: true,\n        value: value\n      };\n    }, function (value) {\n      return {\n        fulfilled: false,\n        value: value\n      };\n    });\n  }));\n}\nexport function collectErrors(_ref) {\n  var validations = _ref.validations,\n      value = _ref.value,\n      path = _ref.path,\n      sync = _ref.sync,\n      errors = _ref.errors,\n      sort = _ref.sort;\n  errors = unwrapError(errors);\n  return settled(validations, sync).then(function (results) {\n    var nestedErrors = results.filter(function (r) {\n      return !r.fulfilled;\n    }).reduce(function (arr, _ref2) {\n      var error = _ref2.value; // we are only collecting validation errors\n\n      if (!ValidationError.isError(error)) {\n        throw error;\n      }\n\n      return arr.concat(error);\n    }, []);\n    if (sort) nestedErrors.sort(sort); //show parent errors after the nested ones: name.first, name\n\n    errors = nestedErrors.concat(errors);\n    if (errors.length) throw new ValidationError(errors, value, path);\n    return value;\n  });\n}\nexport default function runValidations(_ref3) {\n  var endEarly = _ref3.endEarly,\n      options = _objectWithoutPropertiesLoose(_ref3, [\"endEarly\"]);\n\n  if (endEarly) return scopeToValue(options.validations, options.value, options.sync);\n  return collectErrors(options);\n}","map":{"version":3,"sources":["/home/abefernan/cosmwasm/dApps/node_modules/yup/es/util/runValidations.js"],"names":["_objectWithoutPropertiesLoose","SynchronousPromise","ValidationError","promise","sync","Promise","unwrapError","errors","inner","length","concat","scopeToValue","promises","value","p","all","b","catch","err","name","c","then","propagateErrors","endEarly","push","settled","map","resolve","fulfilled","collectErrors","_ref","validations","path","sort","results","nestedErrors","filter","r","reduce","arr","_ref2","error","isError","runValidations","_ref3","options"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport { SynchronousPromise } from 'synchronous-promise';\nimport ValidationError from '../ValidationError';\n\nvar promise = function promise(sync) {\n  return sync ? SynchronousPromise : Promise;\n};\n\nvar unwrapError = function unwrapError(errors) {\n  if (errors === void 0) {\n    errors = [];\n  }\n\n  return errors.inner && errors.inner.length ? errors.inner : [].concat(errors);\n};\n\nfunction scopeToValue(promises, value, sync) {\n  //console.log('scopeToValue', promises, value)\n  var p = promise(sync).all(promises); //console.log('scopeToValue B', p)\n\n  var b = p.catch(function (err) {\n    if (err.name === 'ValidationError') err.value = value;\n    throw err;\n  }); //console.log('scopeToValue c', b)\n\n  var c = b.then(function () {\n    return value;\n  }); //console.log('scopeToValue d', c)\n\n  return c;\n}\n/**\n * If not failing on the first error, catch the errors\n * and collect them in an array\n */\n\n\nexport function propagateErrors(endEarly, errors) {\n  return endEarly ? null : function (err) {\n    errors.push(err);\n    return err.value;\n  };\n}\nexport function settled(promises, sync) {\n  var Promise = promise(sync);\n  return Promise.all(promises.map(function (p) {\n    return Promise.resolve(p).then(function (value) {\n      return {\n        fulfilled: true,\n        value: value\n      };\n    }, function (value) {\n      return {\n        fulfilled: false,\n        value: value\n      };\n    });\n  }));\n}\nexport function collectErrors(_ref) {\n  var validations = _ref.validations,\n      value = _ref.value,\n      path = _ref.path,\n      sync = _ref.sync,\n      errors = _ref.errors,\n      sort = _ref.sort;\n  errors = unwrapError(errors);\n  return settled(validations, sync).then(function (results) {\n    var nestedErrors = results.filter(function (r) {\n      return !r.fulfilled;\n    }).reduce(function (arr, _ref2) {\n      var error = _ref2.value;\n\n      // we are only collecting validation errors\n      if (!ValidationError.isError(error)) {\n        throw error;\n      }\n\n      return arr.concat(error);\n    }, []);\n    if (sort) nestedErrors.sort(sort); //show parent errors after the nested ones: name.first, name\n\n    errors = nestedErrors.concat(errors);\n    if (errors.length) throw new ValidationError(errors, value, path);\n    return value;\n  });\n}\nexport default function runValidations(_ref3) {\n  var endEarly = _ref3.endEarly,\n      options = _objectWithoutPropertiesLoose(_ref3, [\"endEarly\"]);\n\n  if (endEarly) return scopeToValue(options.validations, options.value, options.sync);\n  return collectErrors(options);\n}"]},"metadata":{},"sourceType":"module"}