{"ast":null,"code":"var _jsxFileName = \"/home/abefernan/cosmwasm/dApps/packages/name-service/src/service/wallet.tsx\";\nimport ky from \"ky\";\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport { createClient, loadOrCreateWallet } from \"./sdk\";\nconst defaultContext = {\n  initialized: false,\n  address: \"\",\n  init: () => Promise.resolve(),\n  getClient: () => {\n    throw new Error(\"not yet initialized\");\n  }\n};\nexport const CosmWasmContext = React.createContext(defaultContext);\nexport const useSdk = () => React.useContext(CosmWasmContext);\nexport function BurnerWalletProvider(props) {\n  return /*#__PURE__*/React.createElement(SdkProvider, {\n    config: props.config,\n    loadWallet: loadOrCreateWallet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 5\n    }\n  }, props.children);\n}\nexport function SdkProvider({\n  config,\n  loadWallet,\n  children\n}) {\n  const contextWithInit = { ...defaultContext,\n    init: init\n  };\n  const [value, setValue] = useState(contextWithInit);\n\n  async function init() {\n    return loadWallet(config.addressPrefix).then(signer => createClient(config.httpUrl, signer)).then(async client => {\n      const address = client.senderAddress; // load from faucet if needed\n\n      if (config.faucetUrl) {\n        var _acct$balance;\n\n        const acct = await client.getAccount();\n\n        if (!(acct === null || acct === void 0 ? void 0 : (_acct$balance = acct.balance) === null || _acct$balance === void 0 ? void 0 : _acct$balance.length)) {\n          await ky.post(config.faucetUrl, {\n            json: {\n              ticker: \"COSM\",\n              address\n            }\n          });\n        }\n      }\n\n      setValue({\n        initialized: true,\n        address: address,\n        init: () => Promise.resolve(),\n        getClient: () => client\n      });\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(CosmWasmContext.Provider, {\n    value: value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 10\n    }\n  }, children);\n}","map":{"version":3,"sources":["/home/abefernan/cosmwasm/dApps/packages/name-service/src/service/wallet.tsx"],"names":["ky","React","useState","createClient","loadOrCreateWallet","defaultContext","initialized","address","init","Promise","resolve","getClient","Error","CosmWasmContext","createContext","useSdk","useContext","BurnerWalletProvider","props","config","children","SdkProvider","loadWallet","contextWithInit","value","setValue","addressPrefix","then","signer","httpUrl","client","senderAddress","faucetUrl","acct","getAccount","balance","length","post","json","ticker"],"mappings":";AAEA,OAAOA,EAAP,MAAe,IAAf;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,QAAyB,OAAzB;AAEA,SAASC,YAAT,EAAuBC,kBAAvB,QAAiD,OAAjD;AASA,MAAMC,cAAmC,GAAG;AAC1CC,EAAAA,WAAW,EAAE,KAD6B;AAE1CC,EAAAA,OAAO,EAAE,EAFiC;AAG1CC,EAAAA,IAAI,EAAE,MAAMC,OAAO,CAACC,OAAR,EAH8B;AAI1CC,EAAAA,SAAS,EAAE,MAA6B;AACtC,UAAM,IAAIC,KAAJ,CAAU,qBAAV,CAAN;AACD;AANyC,CAA5C;AASA,OAAO,MAAMC,eAAe,GAAGZ,KAAK,CAACa,aAAN,CAAyCT,cAAzC,CAAxB;AAEP,OAAO,MAAMU,MAAM,GAAG,MAA2Bd,KAAK,CAACe,UAAN,CAAiBH,eAAjB,CAA1C;AAOP,OAAO,SAASI,oBAAT,CAA8BC,KAA9B,EAAuE;AAC5E,sBACE,oBAAC,WAAD;AAAa,IAAA,MAAM,EAAEA,KAAK,CAACC,MAA3B;AAAmC,IAAA,UAAU,EAAEf,kBAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGc,KAAK,CAACE,QADT,CADF;AAKD;AAOD,OAAO,SAASC,WAAT,CAAqB;AAAEF,EAAAA,MAAF;AAAUG,EAAAA,UAAV;AAAsBF,EAAAA;AAAtB,CAArB,EAAsF;AAC3F,QAAMG,eAAe,GAAG,EAAE,GAAGlB,cAAL;AAAqBG,IAAAA,IAAI,EAAEA;AAA3B,GAAxB;AACA,QAAM,CAACgB,KAAD,EAAQC,QAAR,IAAoBvB,QAAQ,CAACqB,eAAD,CAAlC;;AAEA,iBAAef,IAAf,GAAsB;AACpB,WAAOc,UAAU,CAACH,MAAM,CAACO,aAAR,CAAV,CACJC,IADI,CACEC,MAAD,IAAYzB,YAAY,CAACgB,MAAM,CAACU,OAAR,EAAiBD,MAAjB,CADzB,EAEJD,IAFI,CAEC,MAAOG,MAAP,IAAkB;AACtB,YAAMvB,OAAO,GAAGuB,MAAM,CAACC,aAAvB,CADsB,CAEtB;;AACA,UAAIZ,MAAM,CAACa,SAAX,EAAsB;AAAA;;AACpB,cAAMC,IAAI,GAAG,MAAMH,MAAM,CAACI,UAAP,EAAnB;;AACA,YAAI,EAACD,IAAD,aAACA,IAAD,wCAACA,IAAI,CAAEE,OAAP,kDAAC,cAAeC,MAAhB,CAAJ,EAA4B;AAC1B,gBAAMpC,EAAE,CAACqC,IAAH,CAAQlB,MAAM,CAACa,SAAf,EAA0B;AAAEM,YAAAA,IAAI,EAAE;AAAEC,cAAAA,MAAM,EAAE,MAAV;AAAkBhC,cAAAA;AAAlB;AAAR,WAA1B,CAAN;AACD;AACF;;AAEDkB,MAAAA,QAAQ,CAAC;AACPnB,QAAAA,WAAW,EAAE,IADN;AAEPC,QAAAA,OAAO,EAAEA,OAFF;AAGPC,QAAAA,IAAI,EAAE,MAAMC,OAAO,CAACC,OAAR,EAHL;AAIPC,QAAAA,SAAS,EAAE,MAAMmB;AAJV,OAAD,CAAR;AAMD,KAlBI,CAAP;AAmBD;;AAED,sBAAO,oBAAC,eAAD,CAAiB,QAAjB;AAA0B,IAAA,KAAK,EAAEN,KAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyCJ,QAAzC,CAAP;AACD","sourcesContent":["import { SigningCosmWasmClient } from \"@cosmjs/cosmwasm\";\nimport { OfflineSigner } from \"@cosmjs/launchpad\";\nimport ky from \"ky\";\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport { AppConfig } from \"../config\";\nimport { createClient, loadOrCreateWallet } from \"./sdk\";\n\nexport interface CosmWasmContextType {\n  readonly initialized: boolean;\n  readonly address: string;\n  readonly init: () => Promise<void>;\n  readonly getClient: () => SigningCosmWasmClient;\n}\n\nconst defaultContext: CosmWasmContextType = {\n  initialized: false,\n  address: \"\",\n  init: () => Promise.resolve(),\n  getClient: (): SigningCosmWasmClient => {\n    throw new Error(\"not yet initialized\");\n  },\n};\n\nexport const CosmWasmContext = React.createContext<CosmWasmContextType>(defaultContext);\n\nexport const useSdk = (): CosmWasmContextType => React.useContext(CosmWasmContext);\n\nexport interface WalletProviderProps {\n  config: AppConfig;\n  children: any;\n}\n\nexport function BurnerWalletProvider(props: WalletProviderProps): JSX.Element {\n  return (\n    <SdkProvider config={props.config} loadWallet={loadOrCreateWallet}>\n      {props.children}\n    </SdkProvider>\n  );\n}\n\nexport interface SdkProviderProps extends React.HTMLAttributes<HTMLOrSVGElement> {\n  config: AppConfig;\n  loadWallet: (addressPrefix: string) => Promise<OfflineSigner>;\n}\n\nexport function SdkProvider({ config, loadWallet, children }: SdkProviderProps): JSX.Element {\n  const contextWithInit = { ...defaultContext, init: init };\n  const [value, setValue] = useState(contextWithInit);\n\n  async function init() {\n    return loadWallet(config.addressPrefix)\n      .then((signer) => createClient(config.httpUrl, signer))\n      .then(async (client) => {\n        const address = client.senderAddress;\n        // load from faucet if needed\n        if (config.faucetUrl) {\n          const acct = await client.getAccount();\n          if (!acct?.balance?.length) {\n            await ky.post(config.faucetUrl, { json: { ticker: \"COSM\", address } });\n          }\n        }\n\n        setValue({\n          initialized: true,\n          address: address,\n          init: () => Promise.resolve(),\n          getClient: () => client,\n        });\n      });\n  }\n\n  return <CosmWasmContext.Provider value={value}>{children}</CosmWasmContext.Provider>;\n}\n"]},"metadata":{},"sourceType":"module"}